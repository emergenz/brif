{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");var _interopRequireWildcard=require(\"@babel/runtime/helpers/interopRequireWildcard\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _slicedToArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));var _objectWithoutProperties2=_interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));var _react=_interopRequireWildcard(require(\"react\"));var _reactNative=require(\"react-native-web/dist/index\");var _Text=_interopRequireDefault(require(\"../Text\"));var _useThemeProps=require(\"../../../hooks/useThemeProps\");var _useHasResponsiveProps=require(\"../../../hooks/useHasResponsiveProps\");var _styled=require(\"../../../utils/styled\");var _this=this,_jsxFileName=\"/Users/adityajamuar/Sites/projects/nativebase/NativeBase/src/components/primitives/Image/index.tsx\";var StyledImage=(0,_styled.makeStyledComponent)(_reactNative.Image);var Image=function Image(props,ref){var _usePropsResolution=(0,_useThemeProps.usePropsResolution)('Image',props),source=_usePropsResolution.source,src=_usePropsResolution.src,fallbackElement=_usePropsResolution.fallbackElement,alt=_usePropsResolution.alt,fallbackSource=_usePropsResolution.fallbackSource,ignoreFallback=_usePropsResolution.ignoreFallback,_alt=_usePropsResolution._alt,resolvedProps=(0,_objectWithoutProperties2.default)(_usePropsResolution,[\"source\",\"src\",\"fallbackElement\",\"alt\",\"fallbackSource\",\"ignoreFallback\",\"_alt\"]);var finalSource=(0,_react.useRef)(null);var getSource=(0,_react.useCallback)(function(){if(source){finalSource.current=source;}else if(src){finalSource.current={uri:src};}return finalSource.current;},[source,src]);var _useState=(0,_react.useState)(getSource()),_useState2=(0,_slicedToArray2.default)(_useState,2),renderedSource=_useState2[0],setSource=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=(0,_slicedToArray2.default)(_useState3,2),alternate=_useState4[0],setAlternate=_useState4[1];var _useState5=(0,_react.useState)(true),_useState6=(0,_slicedToArray2.default)(_useState5,2),fallbackSourceFlag=_useState6[0],setfallbackSourceFlag=_useState6[1];_react.default.useEffect(function(){return function(){finalSource.current=null;};},[source,src,getSource]);var onImageLoadError=(0,_react.useCallback)(function(event){props.onError&&props.onError(event);console.warn(event.nativeEvent.error);if(!ignoreFallback&&fallbackSource&&fallbackSource!==renderedSource&&fallbackSourceFlag){setfallbackSourceFlag(false);setSource(fallbackSource);}else{setAlternate(true);}},[fallbackSource,fallbackSourceFlag,ignoreFallback,props,renderedSource]);if((0,_useHasResponsiveProps.useHasResponsiveProps)(props)){return null;}if(!alt){console.warn('Please pass alt prop to Image component');}if(alternate){if(fallbackElement){if(_react.default.isValidElement(fallbackElement)){return fallbackElement;}}else return _react.default.createElement(_Text.default,(0,_extends2.default)({},_alt,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:74,columnNumber:19}}),alt);}return _react.default.createElement(StyledImage,(0,_extends2.default)({source:renderedSource,accessibilityLabel:alt,alt:alt},resolvedProps,{onError:onImageLoadError,ref:ref,__self:_this,__source:{fileName:_jsxFileName,lineNumber:77,columnNumber:5}}));};var _default=(0,_react.memo)((0,_react.forwardRef)(Image));exports.default=_default;","map":{"version":3,"sources":["index.tsx"],"names":["StyledImage","RNImage","Image","source","src","fallbackElement","alt","fallbackSource","ignoreFallback","_alt","resolvedProps","finalSource","getSource","uri","renderedSource","setSource","alternate","setAlternate","fallbackSourceFlag","setfallbackSourceFlag","React","onImageLoadError","props","console","event"],"mappings":"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","sourcesContent":["import React, { useState, memo, forwardRef, useCallback, useRef } from 'react';\nimport { Image as RNImage } from 'react-native';\nimport Text from '../Text';\nimport { usePropsResolution } from '../../../hooks/useThemeProps';\nimport type { IImageProps } from './types';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\nimport { makeStyledComponent } from '../../../utils/styled';\n\nconst StyledImage = makeStyledComponent(RNImage);\n\nconst Image = (props: IImageProps, ref: any) => {\n  const {\n    source,\n    src,\n    fallbackElement,\n    alt,\n    fallbackSource,\n    ignoreFallback,\n    _alt,\n    ...resolvedProps\n  } = usePropsResolution('Image', props);\n\n  const finalSource: any = useRef(null);\n  const getSource = useCallback(() => {\n    if (source) {\n      finalSource.current = source;\n    } else if (src) {\n      finalSource.current = { uri: src };\n    }\n    return finalSource.current;\n  }, [source, src]);\n\n  const [renderedSource, setSource] = useState(getSource());\n  const [alternate, setAlternate] = useState(false);\n  const [fallbackSourceFlag, setfallbackSourceFlag] = useState(true);\n\n  React.useEffect(() => {\n    return () => {\n      finalSource.current = null;\n    };\n  }, [source, src, getSource]);\n\n  const onImageLoadError = useCallback(\n    (event: any) => {\n      props.onError && props.onError(event);\n      console.warn(event.nativeEvent.error);\n      if (\n        !ignoreFallback &&\n        fallbackSource &&\n        fallbackSource !== renderedSource &&\n        fallbackSourceFlag\n      ) {\n        setfallbackSourceFlag(false);\n        setSource(fallbackSource);\n      } else {\n        setAlternate(true);\n      }\n    },\n    [fallbackSource, fallbackSourceFlag, ignoreFallback, props, renderedSource]\n  );\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n  if (!alt) {\n    console.warn('Please pass alt prop to Image component');\n  }\n\n  if (alternate) {\n    if (fallbackElement) {\n      if (React.isValidElement(fallbackElement)) {\n        return fallbackElement;\n      }\n    } else return <Text {..._alt}>{alt}</Text>;\n  }\n  return (\n    <StyledImage\n      source={renderedSource}\n      accessibilityLabel={alt}\n      alt={alt}\n      {...resolvedProps}\n      onError={onImageLoadError}\n      ref={ref}\n    />\n  );\n};\n\nexport default memo(forwardRef(Image));\nexport type { IImageProps };\n"]},"metadata":{},"sourceType":"script"}