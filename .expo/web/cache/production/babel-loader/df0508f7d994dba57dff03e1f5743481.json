{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.propsFlattener=exports.compareSpecificity=void 0;var _extends3=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _defineProperty2=_interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));var _lodash=_interopRequireDefault(require(\"lodash.merge\"));var _INITIAL_PROP_SPECIFI;var SPECIFICITY_100=100;var SPECIFICITY_70=70;var SPECIFICITY_60=60;var SPECIFICITY_55=55;var SPECIFICITY_50=50;var SPECIFICITY_40=40;var SPECIFICITY_30=30;var SPECIFICITY_10=10;var SPECIFICITY_1=1;var specificityPrecedence=[SPECIFICITY_100,SPECIFICITY_70,SPECIFICITY_60,SPECIFICITY_55,SPECIFICITY_50,SPECIFICITY_40,SPECIFICITY_30,SPECIFICITY_10,SPECIFICITY_1];var INITIAL_PROP_SPECIFICITY=(_INITIAL_PROP_SPECIFI={},(0,_defineProperty2.default)(_INITIAL_PROP_SPECIFI,SPECIFICITY_100,0),(0,_defineProperty2.default)(_INITIAL_PROP_SPECIFI,SPECIFICITY_70,0),(0,_defineProperty2.default)(_INITIAL_PROP_SPECIFI,SPECIFICITY_60,0),(0,_defineProperty2.default)(_INITIAL_PROP_SPECIFI,SPECIFICITY_50,0),(0,_defineProperty2.default)(_INITIAL_PROP_SPECIFI,SPECIFICITY_55,0),(0,_defineProperty2.default)(_INITIAL_PROP_SPECIFI,SPECIFICITY_40,0),(0,_defineProperty2.default)(_INITIAL_PROP_SPECIFI,SPECIFICITY_30,0),(0,_defineProperty2.default)(_INITIAL_PROP_SPECIFI,SPECIFICITY_10,0),(0,_defineProperty2.default)(_INITIAL_PROP_SPECIFI,SPECIFICITY_1,0),_INITIAL_PROP_SPECIFI);var pseudoPropsMap={_web:{dependentOn:'platform',priority:SPECIFICITY_10},_ios:{dependentOn:'platform',priority:SPECIFICITY_10},_android:{dependentOn:'platform',priority:SPECIFICITY_10},_light:{dependentOn:'colormode',priority:SPECIFICITY_10},_dark:{dependentOn:'colormode',priority:SPECIFICITY_10},_indeterminate:{dependentOn:'state',respondTo:'isIndeterminate',priority:SPECIFICITY_30},_checked:{dependentOn:'state',respondTo:'isChecked',priority:SPECIFICITY_30},_loading:{dependentOn:'state',respondTo:'isLoading',priority:SPECIFICITY_30},_readOnly:{dependentOn:'state',respondTo:'isReadOnly',priority:SPECIFICITY_30},_invalid:{dependentOn:'state',respondTo:'isInvalid',priority:SPECIFICITY_40},_focus:{dependentOn:'state',respondTo:'isFocused',priority:SPECIFICITY_50},_focusVisible:{dependentOn:'state',respondTo:'isFocusVisible',priority:SPECIFICITY_55},_hover:{dependentOn:'state',respondTo:'isHovered',priority:SPECIFICITY_60},_pressed:{dependentOn:'state',respondTo:'isPressed',priority:SPECIFICITY_70},_disabled:{dependentOn:'state',respondTo:'isDisabled',priority:SPECIFICITY_100}};var compareSpecificity=function compareSpecificity(exisiting,upcoming,ignorebaseTheme){if(!exisiting)return true;if(!upcoming)return false;var condition=ignorebaseTheme?specificityPrecedence.length-1:specificityPrecedence.length;for(var index=0;index<condition;index++){if(exisiting[specificityPrecedence[index]]>upcoming[specificityPrecedence[index]]){return false;}else if(exisiting[specificityPrecedence[index]]<upcoming[specificityPrecedence[index]]){return true;}}return true;};exports.compareSpecificity=compareSpecificity;var shouldResolvePseudoProp=function shouldResolvePseudoProp(_ref){var property=_ref.property,state=_ref.state,platform=_ref.platform,colormode=_ref.colormode;if(pseudoPropsMap[property].dependentOn==='platform'){return property===\"_\"+platform;}else if(pseudoPropsMap[property].dependentOn==='colormode'){return property===\"_\"+colormode;}else if(pseudoPropsMap[property].dependentOn==='state'){return state[pseudoPropsMap[property].respondTo];}else{return false;}};var simplifyProps=function simplifyProps(_ref2){var props=_ref2.props,colormode=_ref2.colormode,platform=_ref2.platform,state=_ref2.state,currentSpecificity=_ref2.currentSpecificity,previouslyFlattenProps=_ref2.previouslyFlattenProps;var flattenProps=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var specificityMap=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var priority=arguments.length>3?arguments[3]:undefined;for(var property in props){var _pseudoPropsMap$prope,_pseudoPropsMap$prope2;var propertySpecity=currentSpecificity?(0,_extends3.default)({},currentSpecificity):(0,_extends3.default)({},INITIAL_PROP_SPECIFICITY,(0,_defineProperty2.default)({},SPECIFICITY_1,priority));if(state[(_pseudoPropsMap$prope=pseudoPropsMap[property])==null?void 0:_pseudoPropsMap$prope.respondTo]||['_dark','_light','_web','_ios','_android'].includes(property)){if(shouldResolvePseudoProp({property:property,state:state,platform:platform,colormode:colormode})){propertySpecity[pseudoPropsMap[property].priority]++;simplifyProps({props:props[property],colormode:colormode,platform:platform,state:state,currentSpecificity:propertySpecity,previouslyFlattenProps:previouslyFlattenProps},flattenProps,specificityMap,priority);}}else if(state[(_pseudoPropsMap$prope2=pseudoPropsMap[property])==null?void 0:_pseudoPropsMap$prope2.respondTo]===undefined){if(property.startsWith('_')){if(compareSpecificity(specificityMap[property],propertySpecity,false)){specificityMap[property]=propertySpecity;flattenProps[property]=(0,_lodash.default)({},flattenProps[property],props[property]);}else{flattenProps[property]=(0,_lodash.default)({},props[property],flattenProps[property]);}}else{if(compareSpecificity(specificityMap[property],propertySpecity,false)){specificityMap[property]=propertySpecity;flattenProps[property]=props[property];}}}}};var propsFlattener=function propsFlattener(_ref3,priority){var props=_ref3.props,colormode=_ref3.colormode,platform=_ref3.platform,state=_ref3.state,currentSpecificityMap=_ref3.currentSpecificityMap,previouslyFlattenProps=_ref3.previouslyFlattenProps;var flattenProps={};for(var property in props){var _pseudoPropsMap$prope3;if(state[(_pseudoPropsMap$prope3=pseudoPropsMap[property])==null?void 0:_pseudoPropsMap$prope3.respondTo]===undefined&&property.startsWith('_')){flattenProps[property]=previouslyFlattenProps[property];}}var specificityMap=currentSpecificityMap||{};simplifyProps({props:props,colormode:colormode,platform:platform,state:state,currentSpecificityMap:currentSpecificityMap,previouslyFlattenProps:previouslyFlattenProps},flattenProps,specificityMap,priority);return[flattenProps,specificityMap];};exports.propsFlattener=propsFlattener;","map":{"version":3,"sources":["propsFlattener.tsx"],"names":["SPECIFICITY_100","SPECIFICITY_70","SPECIFICITY_60","SPECIFICITY_55","SPECIFICITY_50","SPECIFICITY_40","SPECIFICITY_30","SPECIFICITY_10","SPECIFICITY_1","specificityPrecedence","INITIAL_PROP_SPECIFICITY","pseudoPropsMap","_web","dependentOn","priority","_ios","_android","_light","_dark","_indeterminate","respondTo","_checked","_loading","_readOnly","_invalid","_focus","_focusVisible","_hover","_pressed","_disabled","compareSpecificity","condition","ignorebaseTheme","index","exisiting","upcoming","shouldResolvePseudoProp","property","state","platform","colormode","simplifyProps","props","currentSpecificity","previouslyFlattenProps","flattenProps","specificityMap","propertySpecity","propsFlattener","currentSpecificityMap"],"mappings":"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","sourcesContent":["import merge from 'lodash.merge';\n\nconst SPECIFICITY_100 = 100;\nconst SPECIFICITY_70 = 70;\nconst SPECIFICITY_60 = 60;\nconst SPECIFICITY_55 = 55;\nconst SPECIFICITY_50 = 50;\nconst SPECIFICITY_40 = 40;\nconst SPECIFICITY_30 = 30;\nconst SPECIFICITY_10 = 10;\nconst SPECIFICITY_1 = 1;\nconst specificityPrecedence = [\n  SPECIFICITY_100,\n  SPECIFICITY_70,\n  SPECIFICITY_60,\n  SPECIFICITY_55,\n  SPECIFICITY_50,\n  SPECIFICITY_40,\n  SPECIFICITY_30,\n  SPECIFICITY_10,\n  SPECIFICITY_1,\n];\nconst INITIAL_PROP_SPECIFICITY = {\n  [SPECIFICITY_100]: 0,\n  [SPECIFICITY_70]: 0,\n  [SPECIFICITY_60]: 0,\n  [SPECIFICITY_50]: 0,\n  [SPECIFICITY_55]: 0,\n  [SPECIFICITY_40]: 0,\n  [SPECIFICITY_30]: 0,\n  [SPECIFICITY_10]: 0,\n  [SPECIFICITY_1]: 0,\n};\n\nconst pseudoPropsMap: any = {\n  _web: { dependentOn: 'platform', priority: SPECIFICITY_10 },\n  _ios: { dependentOn: 'platform', priority: SPECIFICITY_10 },\n  _android: { dependentOn: 'platform', priority: SPECIFICITY_10 },\n\n  _light: { dependentOn: 'colormode', priority: SPECIFICITY_10 },\n  _dark: { dependentOn: 'colormode', priority: SPECIFICITY_10 },\n\n  // TODO: have to add more interactionProps and stateProps\n  _indeterminate: {\n    dependentOn: 'state',\n    respondTo: 'isIndeterminate',\n    priority: SPECIFICITY_30,\n  },\n  _checked: {\n    dependentOn: 'state',\n    respondTo: 'isChecked',\n    priority: SPECIFICITY_30,\n  },\n  _loading: {\n    dependentOn: 'state',\n    respondTo: 'isLoading',\n    priority: SPECIFICITY_30,\n  },\n  // Add new pseudeo props in between -------\n  _readOnly: {\n    dependentOn: 'state',\n    respondTo: 'isReadOnly',\n    priority: SPECIFICITY_30,\n  },\n  // Add new pseudeo props in between -------\n  _invalid: {\n    dependentOn: 'state',\n    respondTo: 'isInvalid',\n    priority: SPECIFICITY_40,\n  },\n  _focus: {\n    dependentOn: 'state',\n    respondTo: 'isFocused',\n    priority: SPECIFICITY_50,\n  },\n  _focusVisible: {\n    dependentOn: 'state',\n    respondTo: 'isFocusVisible',\n    priority: SPECIFICITY_55,\n  },\n  _hover: {\n    dependentOn: 'state',\n    respondTo: 'isHovered',\n    priority: SPECIFICITY_60,\n  },\n  _pressed: {\n    dependentOn: 'state',\n    respondTo: 'isPressed',\n    priority: SPECIFICITY_70,\n  },\n  _disabled: {\n    dependentOn: 'state',\n    respondTo: 'isDisabled',\n    priority: SPECIFICITY_100,\n  },\n};\n\nexport const compareSpecificity = (\n  exisiting: any,\n  upcoming: any,\n  ignorebaseTheme?: boolean\n  // property?: any\n) => {\n  if (!exisiting) return true;\n  if (!upcoming) return false;\n  const condition = ignorebaseTheme\n    ? specificityPrecedence.length - 1\n    : specificityPrecedence.length;\n  for (let index = 0; index < condition; index++) {\n    if (\n      exisiting[specificityPrecedence[index]] >\n      upcoming[specificityPrecedence[index]]\n    ) {\n      return false;\n    } else if (\n      exisiting[specificityPrecedence[index]] <\n      upcoming[specificityPrecedence[index]]\n    ) {\n      return true;\n    }\n  }\n  return true;\n};\n\nconst shouldResolvePseudoProp = ({\n  property,\n  state,\n  platform,\n  colormode,\n}: any) => {\n  if (pseudoPropsMap[property].dependentOn === 'platform') {\n    return property === `_${platform}`;\n  } else if (pseudoPropsMap[property].dependentOn === 'colormode') {\n    return property === `_${colormode}`;\n  } else if (pseudoPropsMap[property].dependentOn === 'state') {\n    return state[pseudoPropsMap[property].respondTo];\n  } else {\n    return false;\n  }\n};\n\nconst simplifyProps = (\n  {\n    props,\n    colormode,\n    platform,\n    state,\n    currentSpecificity,\n    previouslyFlattenProps,\n  }: any,\n  flattenProps: any = {},\n  specificityMap: any = {},\n  priority: number\n) => {\n  for (const property in props) {\n    // NOTE: the order is important here. Keep in mind while specificity breakpoints.\n    const propertySpecity = currentSpecificity\n      ? { ...currentSpecificity }\n      : {\n          ...INITIAL_PROP_SPECIFICITY,\n          [SPECIFICITY_1]: priority,\n        };\n\n    if (\n      state[pseudoPropsMap[property]?.respondTo] ||\n      ['_dark', '_light', '_web', '_ios', '_android'].includes(property)\n    ) {\n      if (shouldResolvePseudoProp({ property, state, platform, colormode })) {\n        propertySpecity[pseudoPropsMap[property].priority]++;\n\n        simplifyProps(\n          {\n            props: props[property],\n            colormode,\n            platform,\n            state,\n            currentSpecificity: propertySpecity,\n            previouslyFlattenProps: previouslyFlattenProps,\n          },\n          flattenProps,\n          specificityMap,\n          priority\n        );\n      }\n    } else if (state[pseudoPropsMap[property]?.respondTo] === undefined) {\n      if (property.startsWith('_')) {\n        if (\n          compareSpecificity(specificityMap[property], propertySpecity, false)\n        ) {\n          specificityMap[property] = propertySpecity;\n          // merging internal props (like, _text, _checked, ...)\n          flattenProps[property] = merge(\n            {},\n            flattenProps[property],\n            props[property]\n          );\n        } else {\n          flattenProps[property] = merge(\n            {},\n            props[property],\n            flattenProps[property]\n          );\n        }\n      } else {\n        if (\n          compareSpecificity(specificityMap[property], propertySpecity, false)\n        ) {\n          specificityMap[property] = propertySpecity;\n          // replacing simple props (like, p, m, bg, color, ...)\n          flattenProps[property] = props[property];\n        }\n      }\n    }\n  }\n};\n\nexport const propsFlattener = (\n  {\n    props,\n    colormode,\n    platform,\n    state,\n    currentSpecificityMap,\n    previouslyFlattenProps,\n  }: any,\n  priority: number\n) => {\n  const flattenProps: any = {};\n\n  for (const property in props) {\n    if (\n      state[pseudoPropsMap[property]?.respondTo] === undefined &&\n      property.startsWith('_')\n    ) {\n      flattenProps[property] = previouslyFlattenProps[property];\n    }\n  }\n\n  const specificityMap = currentSpecificityMap || {};\n\n  // STEP 1.a (if): Check weather it should be recursively resolved\n  // NOTE: (when true) recursively resolved it\n  // STEP 1.b (else if): Check specificty\n  // STEP 1.b.i: Check for pseudo props\n  // NOTE: (when true) Merge it.\n  // NOTE: (when false) Replace it.\n\n  simplifyProps(\n    {\n      props,\n      colormode,\n      platform,\n      state,\n      currentSpecificityMap,\n      previouslyFlattenProps,\n    },\n    flattenProps,\n    specificityMap,\n    priority\n  );\n\n  return [flattenProps, specificityMap];\n};\n"]},"metadata":{},"sourceType":"script"}